{"version":3,"sources":["js/setTime.js","components/Coupon/EditCoupon.js","components/Coupon/Coupon.js","components/Coupon/CouponsList.js"],"names":["changeToDate","number","isTrue","dateTime","Date","setTime","year","getFullYear","month","addZero","getMonth","day","getDate","hour","getHours","min","getMinutes","EditCoupon","open","setOpen","coupon","handleChange","updateCoupon","addCoupon","handleCancel","onClick","htmlFor","id","value","title","name","onChange","code","percent","type","due_date","checked","is_enabled","hasOwnProperty","Coupon","updateIsenable","openUpdateCoupon","updateDate","style","display","width","justifyContent","alignItems","e","CouponsList","alert","useAlert","useState","coupons","setCoupons","setCoupon","loading","setLoading","fetchData","a","fetch","credentials","response","json","data","success","useEffect","Url","method","body","JSON","stringify","headers","result","message","error","event","item","newitem","target","Loading","valueAsNumber","console","log","preCoupon","map","i","key"],"mappings":"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","file":"static/js/5.2cc472a0.chunk.js","sourcesContent":["export const changeToDate = (number, isTrue = false) => {\r\n  let dateTime = new Date();\r\n  dateTime.setTime(number * 1000);\r\n  const year = dateTime.getFullYear();\r\n  const month = addZero(dateTime.getMonth() + 1);\r\n  const day = addZero(dateTime.getDate());\r\n  const hour = addZero(dateTime.getHours());\r\n  const min = addZero(dateTime.getMinutes());\r\n\r\n  let date;\r\n  if (isTrue) {\r\n    date = `${year}-${month}-${day}- ${hour}: ${min}`;\r\n  } else {\r\n    date = `${year}-${month}-${day}`;\r\n  }\r\n  return date;\r\n}\r\n\r\nfunction addZero(number) {\r\n  if (number < 10) {\r\n    number = `0${number}`\r\n  }\r\n  return number;\r\n}","import React from 'react'\r\nimport { changeToDate } from '../../js/setTime';\r\n\r\nexport default function EditCoupon({ open, setOpen, coupon, handleChange, updateCoupon, addCoupon, handleCancel }) {\r\n  return (\r\n    <>\r\n      <button onClick={() => setOpen(!open)}>Add Coupon</button>\r\n      {\r\n        open && (\r\n          <ul>\r\n            <label htmlFor='title'>優惠卷名稱:</label>\r\n            <input\r\n              id='title'\r\n              value={coupon.title || ''}\r\n              name='title'\r\n              onChange={handleChange} />\r\n            <label htmlFor='code'>代碼:</label>\r\n            <input\r\n              id='code'\r\n              value={coupon.code || ''}\r\n              name='code'\r\n              onChange={handleChange} />\r\n            <label htmlFor='percent'>折扣</label>\r\n            <input\r\n              id='percent'\r\n              value={coupon.percent || ''}\r\n              name='percent'\r\n              onChange={handleChange} />\r\n            <label htmlFor='due_date'>使用期限:</label>\r\n            <input\r\n              id='due_date'\r\n              type='date'\r\n              value={changeToDate(coupon.due_date) || ''}\r\n              name='due_date'\r\n              onChange={handleChange} />\r\n            <label htmlFor='is_enable'>是否啟用:</label>\r\n            <input\r\n              id='is_enable'\r\n              type='checkbox'\r\n              checked={(coupon.is_enabled === 1 ? true : false) || ''}\r\n              name='is_enabled'\r\n              onChange={handleChange} />\r\n            {\r\n              coupon.hasOwnProperty('id') ? <button onClick={updateCoupon}>Update</button> : <button onClick={addCoupon}>add</button>\r\n            }\r\n            <button onClick={handleCancel}>Cancel</button>\r\n          </ul>\r\n        )\r\n      }\r\n    </>\r\n  )\r\n}","import React from 'react'\r\nimport { changeToDate } from '../../js/setTime';\r\n\r\nexport default function Coupon({ coupon, updateIsenable, openUpdateCoupon, updateDate }) {\r\n\r\n  function handleDelete() {\r\n    updateDate(null, coupon.id, \"DELETE\")\r\n  }\r\n\r\n  return (\r\n    <li style={{ display: 'flex', width: '50vw', justifyContent: 'space-around', alignItems: 'center' }}>\r\n      <p>{coupon.title}</p>\r\n      <p>{coupon.code}</p>\r\n      <p>{coupon.percent / 100} 折</p>\r\n      <p>{changeToDate(coupon.due_date)}</p>\r\n      <input\r\n        type='checkbox'\r\n        onChange={(e) => updateIsenable(e, coupon)}\r\n        checked={coupon.is_enabled === 1 ? true : false} />\r\n      <button onClick={() => openUpdateCoupon(coupon)}>編輯</button>\r\n      <button onClick={handleDelete}>刪除</button>\r\n    </li>\r\n  )\r\n}","import React, { useState, useEffect } from 'react';\r\nimport { useAlert } from 'react-alert';\r\n\r\nimport EditCoupon from './EditCoupon';\r\nimport Coupon from './Coupon';\r\nimport Loading from '../Loading/Loading';\r\n\r\n\r\nexport default function CouponsList() {\r\n\r\n  const alert = useAlert();\r\n  const [coupons, setCoupons] = useState(null);\r\n  const [coupon, setCoupon] = useState({});\r\n  const [loading, setLoading] = useState(true);\r\n  const [open, setOpen] = useState(false);\r\n\r\n  const fetchData = async () => {\r\n    const Url = 'https://vue-course-api.hexschool.io/api/jay/admin/coupons';\r\n    const response = await fetch(Url, {\r\n      credentials: 'include',\r\n    });\r\n    const data = await response.json();\r\n    if (data.success) {\r\n      setCoupons(data.coupons);\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const updateDate = async (data, id, type) => {\r\n    const Url = id ? `https://vue-course-api.hexschool.io/api/jay/admin/coupon/${id}` : 'https://vue-course-api.hexschool.io/api/jay/admin/coupon';\r\n    const response = await fetch(Url, {\r\n      method: type,\r\n      body: (type === \"PUT\" || type === 'POST') && JSON.stringify({ data: { ...data } }),\r\n      credentials: 'include',\r\n      headers: { 'content-type': (type === 'PUT' || type === 'POST') && 'application/json' },\r\n    });\r\n    const result = await response.json();\r\n    const { success, message } = result;\r\n    if (success) {\r\n      fetchData();\r\n      if (message) {\r\n        alert.success(message);\r\n      }\r\n    } else {\r\n      if (message) {\r\n        alert.error(message);\r\n      }\r\n    }\r\n  }\r\n\r\n  const updateIsenable = (event, item) => {\r\n    const newitem = { ...item, is_enabled: event.target.checked ? 1 : 0 };\r\n    updateDate(newitem, item.id, 'PUT');\r\n  }\r\n\r\n  const openUpdateCoupon = item => {\r\n    setCoupon(item);\r\n    setOpen(true);\r\n  }\r\n\r\n  const handleChange = event => {\r\n    let { name, value, checked, valueAsNumber } = event.target;\r\n    if (name === 'due_date') {\r\n      value = valueAsNumber / 1000;\r\n    } else if (name === 'is_enabled') {\r\n      value = checked ? 1 : 0;\r\n    }\r\n    console.log(name, value);\r\n    setCoupon(preCoupon => {\r\n      return {\r\n        ...preCoupon,\r\n        [name]: value\r\n      }\r\n    })\r\n  }\r\n\r\n  const updateCoupon = () => {\r\n    updateDate(coupon, coupon.id, 'PUT');\r\n    setOpen(false);\r\n  }\r\n\r\n  const addCoupon = () => {\r\n    updateDate(coupon, null, 'POST');\r\n    setCoupon({});\r\n    setOpen(false);\r\n  }\r\n\r\n  const handleCancel = () => {\r\n    setCoupon({})\r\n    setOpen(false)\r\n  }\r\n\r\n  if (loading) {\r\n    return <Loading />\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h2>Coupon</h2>\r\n      <EditCoupon\r\n        open={open}\r\n        setOpen={setOpen}\r\n        coupon={coupon}\r\n        handleChange={handleChange}\r\n        updateCoupon={updateCoupon}\r\n        addCoupon={addCoupon}\r\n        handleCancel={handleCancel}\r\n      />\r\n\r\n      <ul>\r\n        <li style={{ display: 'flex', width: '50vw', justifyContent: 'space-around' }}>\r\n          <p>優惠卷</p>\r\n          <p>代碼</p>\r\n          <p>折扣</p>\r\n          <p>使用期限</p>\r\n          <p>使用</p>\r\n          <p>編輯</p>\r\n          <p>刪除</p>\r\n        </li>\r\n        {\r\n          coupons && coupons.map((coupon, i) => {\r\n            return <Coupon\r\n              key={i}\r\n              coupon={coupon}\r\n              updateIsenable={updateIsenable}\r\n              openUpdateCoupon={openUpdateCoupon}\r\n              updateDate={updateDate}\r\n            />\r\n          })\r\n        }\r\n      </ul>\r\n    </div>\r\n  )\r\n}"],"sourceRoot":""}