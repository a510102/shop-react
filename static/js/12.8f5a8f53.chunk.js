(this["webpackJsonpshop-react"]=this["webpackJsonpshop-react"]||[]).push([[12],{61:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return f}));var n=a(12),c=a.n(n),r=a(18),s=a(10),o=a(0),u=a.n(o),l=a(19),i=a(11),p=a(1),m=a(21),h=a(13);function b(){var e=Object(l.b)(),t=Object(o.useState)({user:{},message:""}),a=Object(s.a)(t,2),n=a[0],i=a[1],p=Object(o.useState)(null),b=Object(s.a)(p,2),f=b[0],j=b[1],d=Object(o.useState)(!1),E=Object(s.a)(d,2),O=E[0],y=E[1],g=Object(o.useState)(!1),v=Object(s.a)(g,2),x=v[0],k=v[1];function C(e){var t=e.target,a=t.name,n=t.value;i((function(e){return"message"===a?Object(h.a)(Object(h.a)({},e),{},Object(m.a)({},a,n)):Object(h.a)(Object(h.a)({},e),{},{user:Object(h.a)(Object(h.a)({},e.user),{},Object(m.a)({},a,n))})}))}function w(){return(w=Object(r.a)(c.a.mark((function t(){var a,r,s,o,u,l;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://vue-course-api.hexschool.io/api/jay/order",a=n.message?Object(h.a)({},n):Object(h.a)(Object(h.a)({},n),{},{message:"\u7121"}),t.next=4,fetch("https://vue-course-api.hexschool.io/api/jay/order",{method:"POST",body:JSON.stringify({data:Object(h.a)({},a)}),headers:{"content-type":"application/json"}});case 4:return r=t.sent,t.next=7,r.json();case 7:s=t.sent,o=s.success,u=s.orderId,l=s.message,o?(j(u),e.success(l),y(!0)):e.error(l);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function S(){return(S=Object(r.a)(c.a.mark((function t(){var a,n,r,s,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="https://vue-course-api.hexschool.io/api/jay/pay/".concat(f),t.next=3,fetch(a,{method:"POST"});case 3:return n=t.sent,t.next=6,n.json();case 6:r=t.sent,s=r.success,o=r.message,s&&(e.show(o),k(!0));case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return u.a.createElement("div",null,x?u.a.createElement("div",null,"\u8cfc\u7269\u5b8c\u6210!"):u.a.createElement(u.a.Fragment,null,u.a.createElement("div",null,u.a.createElement("h2",null,"\u5ba2\u6236\u8cc7\u8a0a"),u.a.createElement("label",{htmlFor:"name"},"\u59d3\u540d:",u.a.createElement("input",{type:"string",name:"name",id:"id",onChange:C})),u.a.createElement("label",{htmlFor:"address"},"\u5730\u5740:",u.a.createElement("input",{type:"string",name:"address",id:"address",onChange:C})),u.a.createElement("label",{htmlFor:"tel"},"\u96fb\u8a71:",u.a.createElement("input",{type:"number",name:"tel",id:"tel",onChange:C})),u.a.createElement("label",{htmlFor:"email"},"E-mail:",u.a.createElement("input",{type:"email",name:"email",id:"email",onChange:C})),u.a.createElement("label",{htmlFor:"message"},"Message:",u.a.createElement("input",{type:"message",name:"message",id:"message",onChange:C})),O?u.a.createElement("button",{onClick:function(){return S.apply(this,arguments)}},"\u78ba\u8a8d\u7d50\u5e33"):u.a.createElement("button",{onClick:function(){return w.apply(this,arguments)}},"\u5b8c\u6210\u8a02\u55ae"))))}function f(){var e=Object(l.b)(),t=Object(p.g)(),a=Object(o.useContext)(i.a),n=a.carts,m=a.dispatch,h=Object(o.useState)(""),f=Object(s.a)(h,2),j=f[0],d=f[1],E=Object(o.useState)(!1),O=Object(s.a)(E,2),y=O[0],g=O[1],v=Object(o.useState)(!0),x=Object(s.a)(v,2),k=x[0],C=x[1];function w(){return S.apply(this,arguments)}function S(){return(S=Object(r.a)(c.a.mark((function e(){var t,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://vue-course-api.hexschool.io/api/jay/cart",e.next=3,fetch("https://vue-course-api.hexschool.io/api/jay/cart");case 3:return t=e.sent,e.next=6,t.json();case 6:(a=e.sent).success&&(m({type:"UPDATE_CART",cart:a.data}),C(!1));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(r.a)(c.a.mark((function t(a){var n,r,s,o,u;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="https://vue-course-api.hexschool.io/api/jay/cart/".concat(a),t.next=3,fetch(n,{method:"DELETE"});case 3:return r=t.sent,t.next=6,r.json();case 6:s=t.sent,o=s.success,u=s.message,o&&(w(),e.success(u));case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function F(){return(F=Object(r.a)(c.a.mark((function t(a){var n,r,s,o,u;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https://vue-course-api.hexschool.io/api/jay/coupon",n={data:{code:a}},t.next=4,fetch("https://vue-course-api.hexschool.io/api/jay/coupon",{method:"POST",body:JSON.stringify(n),headers:{"content-type":"application/json"}});case 4:return r=t.sent,t.next=7,r.json();case 7:s=t.sent,o=s.success,u=s.message,o?(m({type:"UPDATE_PRICE",price:s.data.final_total}),e.success(u)):e.error(u);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(o.useEffect)((function(){w()}),[]),u.a.createElement("div",{className:"shopcart"},!k&&u.a.createElement("ul",{className:"shopcart-itemlist"},n.carts.length?u.a.createElement(u.a.Fragment,null,n.carts.map((function(e,t){return u.a.createElement("li",{className:"shopcart-item",key:t},u.a.createElement("p",null,u.a.createElement("span",null,e.product.title),u.a.createElement("span",null,e.qty," ",e.product.unit),u.a.createElement("span",null,e.total," \u5143")," "),u.a.createElement("button",{onClick:function(){return function(e){return N.apply(this,arguments)}(e.id)}},"\u522a\u9664"))})),u.a.createElement("li",{className:"shopcart-total-price"},"\u7e3d\u5171: ",n.final_total," \u5143"),u.a.createElement("li",{className:"shop-coupon"},u.a.createElement("input",{onChange:function(e){var t=e.target.value;d(t)},value:j}),u.a.createElement("button",{className:"coupon-btn",onClick:function(){return function(e){return F.apply(this,arguments)}(j)}},"\u512a\u60e0")),y&&u.a.createElement(b,null),!y&&u.a.createElement("button",{className:"checkout-btn",onClick:function(){g(!0)}},"\u524d\u5f80\u7d50\u5e33")):u.a.createElement("h3",null,"nothings"),u.a.createElement("button",{className:"bg-red-400 hover:bg-red-600 text-white font-bold py-1 px-2 rounded-full",onClick:function(){t.push("/shop")}},"\u8fd4\u56de")))}}}]);
//# sourceMappingURL=12.8f5a8f53.chunk.js.map