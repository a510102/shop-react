{"version":3,"sources":["components/Pages.js","components/Shop/ShopProduct.js","components/Shop/Shop.js"],"names":["Pages","num","setDePage","dePage","useState","pages","setPages","useEffect","newPages","i","push","setPagesArray","className","onClick","length","map","page","key","Product","data","history","useHistory","alert","useAlert","dispatch","useContext","ShopCartContext","handleAddToCart","id","a","product","product_id","qty","Url","fetch","method","body","JSON","stringify","headers","response","json","result","message","success","show","datas","type","cart","category","title","src","imageUrl","alt","origin_price","price","Shop","products","setProducts","loading","setLoading","fetchProducts","pagination","total_pages","Loading","filterProducts","filter","is_enabled"],"mappings":"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","file":"static/js/3.d2e1173a.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react'\n\nimport './Pages.scss'\n\nexport default function Pages({ num, setDePage, dePage }) {\n  const [pages, setPages] = useState([]);\n\n  useEffect(() => {\n    setPagesArray(num)\n  }, [num])\n\n  function setPagesArray(num) {\n    const newPages = []\n    if (num > 2) {\n      for (let i = 1; i < (num + 1); i++) {\n        newPages.push(i);\n      }\n      setPages(newPages);\n    }\n  }\n\n  return (\n    <ul className='pages'>\n      {\n        dePage !== 1 && <li><button onClick={() => setDePage(dePage - 1)}>Pre</button> </li>\n      }\n      {\n        pages.length > 1 && (pages.map((page, i) => (\n          <li key={i}>\n            <button className={page === dePage ? 'active' : ''} onClick={() => setDePage(page)}>\n              {page}\n            </button>\n          </li>\n        )))\n      }\n      {\n        dePage !== num && <li> <button onClick={() => setDePage(dePage + 1)}>Next</button></li>\n      }\n\n    </ul>\n  )\n} ","import React, { useContext } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { useAlert } from 'react-alert';\r\nimport { ShopCartContext } from './ShopCartContext';\r\nimport './shopProduct.scss';\r\n\r\nexport default function Product({ data }) {\r\n    const history = useHistory();\r\n    const alert = useAlert();\r\n    const { dispatch } = useContext(ShopCartContext);\r\n\r\n    const handleAddToCart = async (id) => {\r\n        const product = { data: { product_id: id, qty: 1 } };\r\n        let Url = 'https://vue-course-api.hexschool.io/api/jay/cart';\r\n        let response = await fetch(Url, {\r\n            method: \"POST\",\r\n            body: JSON.stringify(product),\r\n            headers: { 'content-type': 'application/json' }\r\n        });\r\n        const result = await response.json();\r\n        const { message, success } = result;\r\n        if (success) {\r\n            alert.show(message);\r\n            Url = 'https://vue-course-api.hexschool.io/api/jay/cart';\r\n            response = await fetch(Url);\r\n            const datas = await response.json();\r\n            if (datas.success) {\r\n                dispatch({ type: \"UPDATE_CART\", cart: datas.data })\r\n            }\r\n        }\r\n    }\r\n\r\n    function handlePathToProduct(id) {\r\n        history.push(`/shop/${id}`)\r\n    }\r\n\r\n    return (\r\n        <li id={data.id} className=\"product\">\r\n            <div className='product-content'>\r\n                <h3 className='product-title'>\r\n                    <span>{data.category} :</span>\r\n                    <span>{data.title}</span>\r\n                </h3>\r\n                <div className='product-img' >\r\n                    <img src={data.imageUrl} alt=\"product\" />\r\n                </div>\r\n                <p className='product-price'>\r\n                    <span>原價: {data.origin_price} 元</span>\r\n                    <span>{data.price && `特價: ${data.price} 元 `}</span>\r\n                </p>\r\n            </div>\r\n            <div className='product-btn'>\r\n                <button onClick={() => handleAddToCart(data.id)}>ADD</button>\r\n                <button onClick={() => handlePathToProduct(data.id)}>詳細內容</button>\r\n            </div>\r\n        </li>\r\n    )\r\n}","import React, { useState, useEffect } from 'react'\r\n\r\nimport ShopProduct from './ShopProduct';\r\nimport Loading from '../Loading/Loading';\r\nimport Pages from '../Pages';\r\n\r\nimport './shop.scss';\r\n\r\n\r\n\r\nexport default function Shop() {\r\n\r\n    const [products, setProducts] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [dePage, setDePage] = useState(1)\r\n    const [pages, setPages] = useState(null)\r\n\r\n\r\n    useEffect(() => {\r\n        fetchProducts(dePage);\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [dePage])\r\n\r\n    const fetchProducts = async (page) => {\r\n        const Url = `https://vue-course-api.hexschool.io/api/jay/products?page=${page}`;\r\n        const response = await fetch(Url);\r\n        const datas = await response.json();\r\n        const { success, products, pagination } = datas;\r\n        if (success) {\r\n            setProducts(products);\r\n            setLoading(false);\r\n            setPages(pagination.total_pages)\r\n        }\r\n\r\n    }\r\n\r\n    if (loading) {\r\n        return <Loading />\r\n    }\r\n\r\n    if (!products) {\r\n        return <div> error 404</div>\r\n    }\r\n    const filterProducts = products.filter(data => data.is_enabled === 1);\r\n    return (\r\n        <ul className=\"productlist\">\r\n            {\r\n                filterProducts.length > 0 ? filterProducts.map(data => <ShopProduct data={data} key={data.id} />) : (\r\n                    <div>現在還沒有商品喲~</div>)\r\n            }\r\n            <Pages dePage={dePage} setDePage={setDePage} num={pages} />\r\n        </ul>\r\n    )\r\n}"],"sourceRoot":""}