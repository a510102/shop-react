(this["webpackJsonpshop-react"]=this["webpackJsonpshop-react"]||[]).push([[11],{59:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return f}));var a=n(21),r=n(13),c=n(11),l=n.n(c),u=n(18),o=n(12),i=n(0),s=n.n(i),p=n(20);function m(e){var t=e.open,n=e.setOpen,a=e.product,c=e.handleChange,o=e.updateProduct,p=e.addProduct,m=e.handleCancel,d=e.setProduct,h=e.alert,f=Object(i.useRef)(null),E=function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.current.files[0],(n=new FormData).append("file-to-upload",t),"https://vue-course-api.hexschool.io/api/jay/admin/upload",e.next=6,fetch("https://vue-course-api.hexschool.io/api/jay/admin/upload",{method:"POST",body:n,credentials:"include"});case 6:return a=e.sent,e.next=9,a.json();case 9:(c=e.sent).success?(d((function(e){return Object(r.a)(Object(r.a)({},e),{},{imageUrl:c.imageUrl})})),h.success("\u4e0a\u50b3\u6210\u529f")):h.error(c.message);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{onClick:function(){n(!t)}},"\u5efa\u7acb\u65b0\u5546\u54c1"),t?s.a.createElement("div",null,s.a.createElement("label",{htmlFor:"category"},"\u985e\u5225:"),s.a.createElement("input",{id:"category",name:"category",value:a.category||"",onChange:c}),s.a.createElement("label",{htmlFor:"title"},"\u5546\u54c1:"),s.a.createElement("input",{id:"title",name:"title",value:a.title||"",onChange:c}),s.a.createElement("label",{htmlFor:"content"},"\u5167\u5bb9:"),s.a.createElement("input",{id:"content",name:"content",value:a.content||"",onChange:c}),s.a.createElement("label",{htmlFor:"description"},"\u63cf\u8ff0:"),s.a.createElement("input",{id:"description",name:"description",value:a.description||"",onChange:c}),s.a.createElement("label",{htmlFor:"image"},"\u8f38\u5165\u5716\u7247\u7db2\u5740"),s.a.createElement("input",{type:"text",className:"form-control",onChange:c,value:a.imageUrl||"",id:"image",name:"imageUrl",placeholder:"\u8acb\u8f38\u5165\u5716\u7247\u9023\u7d50"}),s.a.createElement("label",{htmlFor:"customFile"},"\u6216 \u4e0a\u50b3\u5716\u7247"),s.a.createElement("input",{type:"file",id:"customFile",className:"form-control",ref:f,onChange:E}),a.imageUrl&&s.a.createElement("img",{style:{width:"200px",height:"200px"},src:a.imageUrl,alt:"proPic"}),s.a.createElement("label",{htmlFor:"origin_price"},"\u539f\u50f9:"),s.a.createElement("input",{id:"origin_price",name:"origin_price",value:a.origin_price||"",onChange:c}),s.a.createElement("label",{htmlFor:"price"},"\u7279\u50f9:"),s.a.createElement("input",{id:"price",name:"price",value:a.price||"",onChange:c}),s.a.createElement("label",{htmlFor:"unit"},"\u55ae\u4f4d:"),s.a.createElement("input",{id:"unit",name:"unit",value:a.unit||"",onChange:c}),a.hasOwnProperty("id")?s.a.createElement("button",{onClick:o},"Update"):s.a.createElement("button",{onClick:p},"Add"),s.a.createElement("button",{onClick:m},"\u53d6\u6d88")):null)}function d(e){var t=e.product,n=e.updateEnabled,a=e.openUpdateProduct,r=e.deleteProduct;return s.a.createElement("li",{style:{display:"flex",width:"50vw",justifyContent:"space-around",alignItems:"center"}},s.a.createElement("p",null,t.title),s.a.createElement("p",null,t.category),s.a.createElement("p",null,t.unit),s.a.createElement("p",null,t.origin_price,"\u5143"),s.a.createElement("p",null,t.price,"\u5143"),s.a.createElement("input",{type:"checkbox",onChange:function(e){return n(e,t)},checked:1===t.is_enabled}),s.a.createElement("button",{onClick:function(){return a(t)}},"\u7de8\u8f2f"),s.a.createElement("button",{onClick:function(){return r(t.id)}},"\u522a\u9664"))}var h=n(19);function f(){var e=Object(p.b)(),t=Object(i.useState)(null),n=Object(o.a)(t,2),c=n[0],f=n[1],E=Object(i.useState)(!0),b=Object(o.a)(E,2),g=b[0],v=b[1],j=Object(i.useState)(!1),y=Object(o.a)(j,2),O=y[0],C=y[1],x=Object(i.useState)({}),P=Object(o.a)(x,2),k=P[0],w=P[1],F=function(){var e=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://vue-course-api.hexschool.io/api/jay/products",e.next=3,fetch("https://vue-course-api.hexschool.io/api/jay/products");case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,f(n.products),v(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(i.useEffect)((function(){F()}),[]);var U=function(){var t=Object(u.a)(l.a.mark((function t(n,a,c){var u,o,i,s,p;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=a?"https://vue-course-api.hexschool.io/api/jay/admin/product/".concat(a):"https://vue-course-api.hexschool.io/api/jay/admin/product",t.next=3,fetch(u,{method:c,body:("PUT"===c||"POST"===c)&&JSON.stringify({data:Object(r.a)({},n)}),credentials:"include",headers:{"content-type":("PUT"===c||"POST"===c)&&"application/json"}});case 3:return o=t.sent,t.next=6,o.json();case 6:i=t.sent,s=i.success,p=i.message,s?(F(),p&&e.success(p)):p&&e.error(p);case 9:case"end":return t.stop()}}),t)})));return function(e,n,a){return t.apply(this,arguments)}}(),S=function(e,t){var n=e.target.checked,a=Object(r.a)(Object(r.a)({},t),{},{is_enabled:n?1:0});U(a,t.id,"PUT")},T=function(e){w(e),O||C(!0)},_=function(e){U(null,e,"DELETE")};return g?s.a.createElement(h.a,null):s.a.createElement("div",null,s.a.createElement("h2",null,"Products"),s.a.createElement(m,{open:O,setOpen:C,product:k,handleChange:function(e){var t=e.target,n=t.name,c=t.value;w((function(e){return Object(r.a)(Object(r.a)({},e),{},Object(a.a)({},n,c))}))},updateProduct:function(){U(k,k.id,"PUT"),C(!1)},addProduct:function(){U(k,null,"POST"),w({}),C(!1)},handleCancel:function(){w({}),C(!1)},setProduct:w,alert:e}),s.a.createElement("ul",null,s.a.createElement("li",{style:{display:"flex",width:"50vw",justifyContent:"space-around",alignItems:"center"}},s.a.createElement("p",null,"\u7522\u54c1"),s.a.createElement("p",null,"\u985e\u5225"),s.a.createElement("p",null,"\u55ae\u4f4d"),s.a.createElement("p",null,"\u539f\u50f9"),s.a.createElement("p",null,"\u7279\u50f9"),s.a.createElement("p",null,"\u555f\u7528")),c&&c.map((function(e,t){return s.a.createElement(d,{product:e,key:t,updateEnabled:S,openUpdateProduct:T,deleteProduct:_})}))))}}}]);
//# sourceMappingURL=11.943509f9.chunk.js.map