{"version":3,"sources":["components/Products/EditProduct.js","components/Products/BackProduct.js","components/Products/Products.js"],"names":["EditProduct","open","setOpen","product","handleChange","updateProduct","addProduct","handleCancel","setProduct","alert","inputEl","useRef","uploadFild","a","uploadedFile","current","files","formData","FormData","append","fetch","method","body","credentials","response","json","result","success","preProducts","imageUrl","error","message","onClick","htmlFor","id","name","value","category","onChange","title","content","description","type","className","placeholder","ref","style","width","height","src","alt","origin_price","price","unit","hasOwnProperty","BackProduct","updateEnabled","openUpdateProduct","deleteProduct","display","justifyContent","alignItems","e","checked","is_enabled","Products","useAlert","useState","products","setProducts","loading","setLoading","fetchProducts","data","useEffect","updateData","Url","JSON","stringify","headers","item","target","newproduct","Loading","event","preProduct","map","i","key"],"mappings":"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","file":"static/js/11.943509f9.chunk.js","sourcesContent":["import React, { useRef } from 'react'\r\n\r\n\r\nexport default function EditProduct({ open, setOpen, product, handleChange, updateProduct, addProduct, handleCancel, setProduct, alert }) {\r\n  const inputEl = useRef(null);\r\n\r\n  const uploadFild = async () => {\r\n    const uploadedFile = inputEl.current.files[0];\r\n    const formData = new FormData();\r\n    formData.append('file-to-upload', uploadedFile);\r\n    const Url = 'https://vue-course-api.hexschool.io/api/jay/admin/upload';\r\n    const response = await fetch(Url, {\r\n      method: 'POST',\r\n      body: formData,\r\n      credentials: 'include',\r\n    })\r\n    const result = await response.json();\r\n    if (result.success) {\r\n      setProduct(preProducts => {\r\n        return {\r\n          ...preProducts,\r\n          imageUrl: result.imageUrl\r\n        }\r\n      });\r\n      alert.success('上傳成功');\r\n    } else {\r\n      alert.error(result.message);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <button onClick={() => { setOpen(!open) }}>建立新商品</button>\r\n      {\r\n        open ? (\r\n          <div>\r\n            <label htmlFor='category'>類別:</label>\r\n            <input\r\n              id='category'\r\n              name='category'\r\n              value={product.category || ''}\r\n              onChange={handleChange} />\r\n            <label htmlFor='title'>商品:</label>\r\n            <input\r\n              id='title'\r\n              name='title'\r\n              value={product.title || ''}\r\n              onChange={handleChange} />\r\n            <label htmlFor='content'>內容:</label>\r\n            <input\r\n              id='content'\r\n              name='content'\r\n              value={product.content || ''}\r\n              onChange={handleChange} />\r\n            <label htmlFor='description'>描述:</label>\r\n            <input\r\n              id='description'\r\n              name='description'\r\n              value={product.description || ''}\r\n              onChange={handleChange} />\r\n            <label htmlFor=\"image\">輸入圖片網址</label>\r\n            <input\r\n              type=\"text\"\r\n              className=\"form-control\"\r\n              onChange={handleChange}\r\n              value={product.imageUrl || ''}\r\n              id=\"image\"\r\n              name='imageUrl'\r\n              placeholder=\"請輸入圖片連結\" />\r\n            <label htmlFor=\"customFile\">或 上傳圖片</label>\r\n            <input type=\"file\" id=\"customFile\" className=\"form-control\"\r\n              ref={inputEl} onChange={uploadFild} />\r\n            {\r\n              product.imageUrl && <img style={{ width: '200px', height: '200px' }} src={product.imageUrl} alt='proPic' />\r\n            }\r\n            <label htmlFor='origin_price'>原價:</label>\r\n            <input\r\n              id='origin_price'\r\n              name='origin_price'\r\n              value={product.origin_price || ''}\r\n              onChange={handleChange} />\r\n            <label htmlFor='price'>特價:</label>\r\n            <input\r\n              id='price'\r\n              name='price'\r\n              value={product.price || ''}\r\n              onChange={handleChange} />\r\n            <label htmlFor='unit'>單位:</label>\r\n            <input\r\n              id='unit'\r\n              name='unit'\r\n              value={product.unit || ''}\r\n              onChange={handleChange} />\r\n            {\r\n              !product.hasOwnProperty('id') ? <button onClick={addProduct}>Add</button> : <button onClick={updateProduct}>Update</button>\r\n            }\r\n            <button onClick={handleCancel}>取消</button>\r\n          </div>\r\n        ) : null\r\n      }\r\n    </>\r\n  )\r\n}","import React from 'react'\r\n\r\nexport default function BackProduct({ product, updateEnabled, openUpdateProduct, deleteProduct }) {\r\n  return (\r\n    <li style={{ display: 'flex', width: '50vw', justifyContent: 'space-around', alignItems: 'center' }}>\r\n      <p>{product.title}</p>\r\n      <p>{product.category}</p>\r\n      <p>{product.unit}</p>\r\n      <p>{product.origin_price}元</p>\r\n      <p>{product.price}元</p>\r\n      <input\r\n        type=\"checkbox\"\r\n        onChange={(e) => updateEnabled(e, product)}\r\n        checked={product.is_enabled === 1 ? true : false}\r\n      />\r\n      <button onClick={() => openUpdateProduct(product)}>編輯</button>\r\n      <button onClick={() => deleteProduct(product.id)}>刪除</button>\r\n    </li>\r\n  )\r\n}","import React, { useEffect, useState } from 'react';\r\nimport { useAlert } from 'react-alert';\r\n\r\nimport EditProduct from './EditProduct';\r\nimport BackProduct from './BackProduct';\r\nimport Loading from '../Loading/Loading';\r\n\r\nexport default function Products() {\r\n  const alert = useAlert();\r\n\r\n  const [products, setProducts] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [open, setOpen] = useState(false);\r\n  const [product, setProduct] = useState({})\r\n\r\n  const fetchProducts = async () => {\r\n    const Url = 'https://vue-course-api.hexschool.io/api/jay/products';\r\n    const response = await fetch(Url);\r\n    const data = await response.json()\r\n    setProducts(data.products)\r\n    setLoading(false);\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchProducts();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [])\r\n\r\n  const updateData = async (data, id, type) => {\r\n    let Url;\r\n    if (id) {\r\n      Url = `https://vue-course-api.hexschool.io/api/jay/admin/product/${id}`;\r\n    } else {\r\n      Url = `https://vue-course-api.hexschool.io/api/jay/admin/product`;\r\n    }\r\n\r\n    const response = await fetch(Url, {\r\n      method: type,\r\n      body: (type === 'PUT' || type === 'POST') && JSON.stringify({ data: { ...data } }),\r\n      credentials: 'include',\r\n      headers: { 'content-type': (type === 'PUT' || type === 'POST') && 'application/json' },\r\n    });\r\n    const result = await response.json();\r\n    const { success, message } = result;\r\n    if (success) {\r\n      fetchProducts();\r\n      if (message) {\r\n        alert.success(message);\r\n      }\r\n    } else {\r\n      if (message) {\r\n        alert.error(message)\r\n      }\r\n    }\r\n  }\r\n\r\n  const updateEnabled = (e, item) => {\r\n    const { checked } = e.target;\r\n    const newproduct = { ...item, is_enabled: checked ? 1 : 0 };\r\n    updateData(newproduct, item.id, 'PUT');\r\n  }\r\n\r\n  const openUpdateProduct = item => {\r\n    setProduct(item);\r\n    if (!open) {\r\n      setOpen(true);\r\n    }\r\n  }\r\n\r\n  const handleChange = event => {\r\n    const { name, value } = event.target;\r\n    setProduct(preProduct => {\r\n      return {\r\n        ...preProduct,\r\n        [name]: value\r\n      }\r\n    })\r\n  }\r\n\r\n  const addProduct = () => {\r\n    updateData(product, null, 'POST');\r\n    setProduct({});\r\n    setOpen(false);\r\n  }\r\n\r\n  const updateProduct = () => {\r\n    updateData(product, product.id, 'PUT');\r\n    setOpen(false);\r\n  }\r\n\r\n  const deleteProduct = (id) => {\r\n    updateData(null, id, 'DELETE');\r\n  }\r\n\r\n  const handleCancel = () => {\r\n    setProduct({});\r\n    setOpen(false);\r\n  }\r\n\r\n  if (loading) {\r\n    return <Loading />\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h2>Products</h2>\r\n      <EditProduct\r\n        open={open}\r\n        setOpen={setOpen}\r\n        product={product}\r\n        handleChange={handleChange}\r\n        updateProduct={updateProduct}\r\n        addProduct={addProduct}\r\n        handleCancel={handleCancel}\r\n        setProduct={setProduct}\r\n        alert={alert}\r\n      />\r\n      <ul>\r\n        <li style={{ display: 'flex', width: '50vw', justifyContent: 'space-around', alignItems: 'center' }}>\r\n          <p>產品</p>\r\n          <p>類別</p>\r\n          <p>單位</p>\r\n          <p>原價</p>\r\n          <p>特價</p>\r\n          <p>啟用</p>\r\n        </li>\r\n        {\r\n          products && products.map((product, i) => {\r\n            return <BackProduct\r\n              product={product}\r\n              key={i}\r\n              updateEnabled={updateEnabled}\r\n              openUpdateProduct={openUpdateProduct}\r\n              deleteProduct={deleteProduct} />\r\n          })\r\n        }\r\n      </ul>\r\n    </div>\r\n\r\n  )\r\n}"],"sourceRoot":""}