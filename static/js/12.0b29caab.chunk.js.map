{"version":3,"sources":["components/CheckOut.js","components/ShopCart/ShopCart.js"],"names":["CheckOut","alert","useAlert","useState","user","message","order","setOrder","id","setId","pay","setPay","done","setDone","handleChange","event","target","name","value","preOrder","a","newOrder","fetch","method","body","JSON","stringify","data","headers","response","json","datas","success","orderId","error","Url","show","style","className","htmlFor","type","onChange","onClick","ShopCart","history","useHistory","useContext","ShopContext","carts","cartDispatch","coupon","setCoupon","open","setOpen","loading","setLoading","fetchData","console","log","cart","result","text","code","price","final_total","useEffect","length","map","i","key","product","title","qty","unit","total","handleDeleCart","placeholder","handleCoupon","push"],"mappings":"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","file":"static/js/12.0b29caab.chunk.js","sourcesContent":["import React, { useState } from 'react'\r\nimport { useAlert } from 'react-alert';\r\n\r\n\r\nexport default function CheckOut() {\r\n  const alert = useAlert();\r\n  const [order, setOrder] = useState({\r\n    user: {},\r\n    message: ''\r\n  });\r\n  const [id, setId] = useState(null);\r\n  const [pay, setPay] = useState(false);\r\n  const [done, setDone] = useState(false);\r\n\r\n  function handleChange(event) {\r\n    const { name, value } = event.target;\r\n    setOrder(preOrder => {\r\n      if (name === 'message') {\r\n        return {\r\n          ...preOrder,\r\n          [name]: value\r\n        }\r\n      } else {\r\n        return {\r\n          ...preOrder,\r\n          user: {\r\n            ...preOrder.user,\r\n            [name]: value\r\n          }\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  async function AddOrder() {\r\n    const Url = 'https://vue-course-api.hexschool.io/api/jay/order';\r\n    let newOrder;\r\n    if (!order.message) {\r\n      newOrder = {\r\n        ...order,\r\n        message: '無'\r\n      };\r\n    } else {\r\n      newOrder = { ...order };\r\n    }\r\n    const response = await fetch(Url, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ data: { ...newOrder } }),\r\n      headers: { 'content-type': 'application/json' }\r\n    });\r\n    const datas = await response.json();\r\n    const { success, orderId, message } = datas;\r\n\r\n    if (success) {\r\n      setId(orderId);\r\n      alert.success(message);\r\n      setPay(true);\r\n    } else {\r\n      alert.error(message);\r\n    }\r\n  }\r\n\r\n  async function handlePay() {\r\n    const Url = `https://vue-course-api.hexschool.io/api/jay/pay/${id}`;\r\n    const response = await fetch(Url, { method: 'POST' });\r\n    const datas = await response.json();\r\n    const { success, message } = datas;\r\n\r\n    if (success) {\r\n      alert.show(message);\r\n      setDone(true);\r\n    }\r\n  }\r\n\r\n  const style = {\r\n    div: 'w-full  px-3 mt-3 mb-6 md:mb-0',\r\n    label: 'block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2',\r\n    input: 'appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\" id=\"grid-last-name',\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {!done ? (<>\r\n        <h2 className='text-gray-800 text-xl'>客戶資訊</h2>\r\n        <div className='flex flex-wrap mb-6 text-left'>\r\n          <section className={style.div}>\r\n            <label className={style.label} htmlFor='name'>姓名:</label>\r\n            <input\r\n              className={style.input}\r\n              type='string'\r\n              name='name'\r\n              id='id'\r\n              onChange={handleChange} />\r\n          </section>\r\n          <section className={style.div}>\r\n            <label className={style.label} htmlFor='address'>地址: </label>\r\n            <input\r\n              className={style.input}\r\n              type='string'\r\n              name='address'\r\n              id='address'\r\n              onChange={handleChange} />\r\n          </section>\r\n          <section className={style.div}>\r\n            <label className={style.label} htmlFor='tel'>電話:</label>\r\n            <input\r\n              className={style.input}\r\n              type='number'\r\n              name='tel'\r\n              id='tel'\r\n              onChange={handleChange} />\r\n          </section>\r\n          <section className={style.div}>\r\n            <label className={style.label} htmlFor='email'>E-mail:</label>\r\n            <input\r\n              className={style.input}\r\n              type='email'\r\n              name='email'\r\n              id='email'\r\n              onChange={handleChange} />\r\n          </section>\r\n          <section className={style.div}>\r\n            <label className={style.label} htmlFor='message'>Message: </label>\r\n            <input\r\n              className={style.input}\r\n              type='message'\r\n              name='message'\r\n              id='message'\r\n              onChange={handleChange} />\r\n          </section>\r\n          <section className='w-full  px-3 mt-3 mb-6 md:mb-0 sm:relative flex justify-end items-end'>\r\n            {\r\n              !pay ? <button onClick={AddOrder} className='bg-teal-500 hover:bg-teal-700 text-white font-bold py-1 px-2 rounded '>完成訂單</button> : <button onClick={handlePay} className='bg-teal-500 hover:bg-teal-700 text-white font-bold py-1 px-2 rounded '>確認結帳</button>\r\n            }\r\n          </section>\r\n        </div>\r\n      </>) : <div className='w-full flex justify-center items-center h-screen text-lg'>購物完成!</div>\r\n      }\r\n    </div>\r\n  )\r\n}","import React, { useState, useEffect, useContext } from 'react';\r\nimport { useAlert } from 'react-alert'\r\nimport { ShopContext } from '../../contexts/shopCartContext/ShopCartContext';\r\nimport { useHistory } from 'react-router-dom'\r\nimport CheckOut from '../CheckOut';\r\n\r\nexport default function ShopCart() {\r\n    const alert = useAlert();\r\n    const history = useHistory();\r\n\r\n    const { carts, cartDispatch } = useContext(ShopContext);\r\n    const [coupon, setCoupon] = useState('');\r\n    const [open, setOpen] = useState(false);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        fetchData();\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    async function fetchData() {\r\n        const Url = 'https://vue-course-api.hexschool.io/api/jay/cart';\r\n        const response = await fetch(Url);\r\n        const datas = await response.json();\r\n        if (datas.success) {\r\n            console.log(datas.data)\r\n            cartDispatch({ type: \"UPDATE_CART\", cart: datas.data });\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    async function handleDeleCart(id) {\r\n        const Url = `https://vue-course-api.hexschool.io/api/jay/cart/${id}`;\r\n        const response = await fetch(Url, { method: \"DELETE\" });\r\n        const result = await response.json();\r\n        const { success, message } = result;\r\n        if (success) {\r\n            fetchData();\r\n            alert.success(message)\r\n        }\r\n    }\r\n\r\n    function handleChange(event) {\r\n        const value = event.target.value;\r\n        setCoupon(value);\r\n    }\r\n\r\n    async function handleCoupon(text) {\r\n        const Url = 'https://vue-course-api.hexschool.io/api/jay/coupon';\r\n        const data = { data: { code: text } }\r\n        const response = await fetch(Url, { method: 'POST', body: JSON.stringify(data), headers: { 'content-type': 'application/json' } });\r\n        const result = await response.json();\r\n\r\n        const { success, message } = result;\r\n\r\n        if (success) {\r\n            cartDispatch({ type: \"UPDATE_PRICE\", price: result.data.final_total });\r\n            alert.success(message);\r\n        } else {\r\n            alert.error(message);\r\n        }\r\n    };\r\n\r\n    function handleCheckOut() {\r\n        setOpen(true);\r\n    }\r\n\r\n\r\n    return (\r\n        <div className='my-4 mx-auto p-2 min-h-screen'>\r\n            <h2 className='text-xl p-2 w-full border border-teal-500 text-teal-500 rounded-lg'>您的購物車</h2>\r\n            {\r\n                !loading && (\r\n                    <div className='w-full text-right grid grid-cols-1 md:grid-cols-2 gap-2 lg:gap-4'>\r\n                        {\r\n                            !carts.carts.length ? <h3 className='text-4xl my-4 text-center'>nothings</h3> : (\r\n                                <>\r\n                                    <ul className='w-full'>\r\n                                        <li className='p-2 flex border-b-2 items-center justify-around border-gray-600'>\r\n                                            <p>名字</p>\r\n                                            <p>數量</p>\r\n                                            <p>價格</p>\r\n                                            <p>刪除</p>\r\n                                        </li>\r\n                                        {carts.carts.map((cart, i) => {\r\n                                            return (\r\n                                                <li\r\n                                                    className='ml-auto p-2 flex border-b-2 items-center justify-around border-gray-600'\r\n                                                    key={i}>\r\n                                                    <p>\r\n                                                        {cart.product.title}\r\n                                                    </p>\r\n                                                    <p>\r\n                                                        {cart.qty} {cart.product.unit}\r\n                                                    </p>\r\n                                                    <p className='ml-4'>{cart.total} 元\r\n                                                        </p>\r\n                                                    <button\r\n                                                        className='bg-red-500 hover:bg-red-600 text-white font-bold py-1 px-2 rounded-lg'\r\n                                                        onClick={() => handleDeleCart(cart.id)}>刪除</button>\r\n                                                </li>\r\n                                            )\r\n                                        })}\r\n                                    </ul>\r\n                                    <div className='w-full'>\r\n                                        <p className='p-2'>共 {carts.carts.length} 件，總共: {carts.final_total} 元</p>\r\n                                        <div className='p-2'>\r\n                                            <input className='p-2 text-indigo-400 border border-teal-400 rounded-md' onChange={handleChange}\r\n                                                placeholder='輸入優惠卷代碼'\r\n                                                value={coupon || ''} />\r\n                                            <button\r\n                                                className='ml-2 bg-indigo-400 hover:bg-indigo-600 text-white font-bold py-1 px-2 rounded-lg'\r\n                                                onClick={() => handleCoupon(coupon)}>優惠</button>\r\n                                        </div>\r\n                                        {\r\n                                            open ? <CheckOut /> : <button\r\n                                                className='mr-2 mt-2 bg-teal-400 hover:bg-teal-600 text-white font-bold py-1 px-2 rounded-lg'\r\n                                                onClick={handleCheckOut}>前往結帳</button>\r\n                                        }\r\n                                        <button\r\n                                            className='bg-blue-400 hover:bg-blue-600 text-white font-bold py-1 px-2 rounded-lg'\r\n                                            onClick={() => { history.push('/shop-react/shop') }}>返回</button>\r\n                                    </div>\r\n                                </>\r\n                            )\r\n                        }\r\n                    </div>\r\n                )\r\n            }\r\n        </div >\r\n    )\r\n}"],"sourceRoot":""}