{"version":3,"sources":["components/Login.js"],"names":["Login","history","useHistory","alert","useAlert","userDispatch","useContext","ShopContext","useState","username","password","user","setUser","loading","setLoading","handleChange","event","target","name","value","preUser","a","preventDefault","fetch","method","body","JSON","stringify","credentials","headers","response","json","result","success","message","type","push","replace","error","show","className","onSubmit","placeholder","onChange","onClick"],"mappings":"kQAMe,SAASA,IACtB,IAAMC,EAAUC,cACVC,EAAQC,cACNC,EAAiBC,qBAAWC,KAA5BF,aAHsB,EAKNG,mBAAS,CAC/BC,SAAU,GACVC,SAAU,KAPkB,mBAKvBC,EALuB,KAKjBC,EALiB,OAUAJ,oBAAS,GAVT,mBAUvBK,EAVuB,KAUdC,EAVc,KAa9B,SAASC,EAAaC,GAAQ,IAAD,EACHA,EAAMC,OAAtBC,EADmB,EACnBA,KAAMC,EADa,EACbA,MACdP,GAAQ,SAAAQ,GACN,OAAO,2BACFA,GADL,kBAEGF,EAAOC,OAlBgB,4CAuB9B,WAA2BH,GAA3B,yBAAAK,EAAA,yDACEL,EAAMM,iBAEEb,EAAuBE,EAAvBF,SAAUC,EAAaC,EAAbD,UACdD,IAAYC,EAJlB,wBAKII,GAAW,GACC,mDANhB,SAO2BS,MADX,mDACsB,CAChCC,OAAQ,OACRC,KAAMC,KAAKC,UAAUhB,GACrBiB,YAAa,UACbC,QAAS,CAAE,eAAgB,sBAXjC,cAOUC,EAPV,iBAayBA,EAASC,OAblC,QAaUC,EAbV,OAcYC,EAAqBD,EAArBC,QAASC,EAAYF,EAAZE,QACbD,GACFnB,GAAW,GACXT,EAAa,CAAE8B,KAAM,YACrBlC,EAAQmC,KAAK,0BAEbtB,GAAW,GACXb,EAAQoC,QAAQ,qBAChBlC,EAAMmC,MAAMJ,IAtBlB,yBAwBczB,GAAYC,EACtBP,EAAMoC,KAAK,6BACD7B,GAAYD,EACtBN,EAAMoC,KAAK,8BAEXpC,EAAMoC,KAAK,0CA7Bf,6CAvB8B,sBAyD9B,OAAI1B,EACK,kBAAC,IAAD,MAKP,yBAAK2B,UAAU,mCACb,0BAAMC,SAhEoB,4CAgEGD,UAAU,kDACrC,wBAAIA,UAAU,+BAAd,UACA,yBAAKA,UAAU,QACb,2BAAOA,UAAU,8CAAjB,WACF,2BACMA,UAAU,6HACVL,KAAK,QACLO,YAAY,QACZxB,KAAK,WACLyB,SAAU5B,EACVI,MAAOR,EAAKF,aAGlB,yBAAK+B,UAAU,QACb,2BAAOA,UAAU,8CAAjB,cACF,2BACMA,UAAU,kIACVL,KAAK,mBACLO,YAAY,WACZxB,KAAK,WACLyB,SAAU5B,EACVI,MAAOR,EAAKD,aAGlB,yBAAK8B,UAAU,qCACb,4BAAQA,UAAU,+GAA+GL,KAAK,UAAtI,UACA,4BAAQK,UAAU,kFAAkFI,QAAS,WAAQ3C,EAAQmC,KAAK,sBAAlI","file":"static/js/9.6b9a0c83.chunk.js","sourcesContent":["import React, { useState, useContext } from 'react'\r\nimport { useHistory } from 'react-router-dom';\r\nimport { useAlert } from 'react-alert';\r\nimport Loading from './Loading/Loading';\r\nimport { ShopContext } from '../contexts/shopCartContext/ShopCartContext';\r\n\r\nexport default function Login() {\r\n  const history = useHistory();\r\n  const alert = useAlert();\r\n  const { userDispatch } = useContext(ShopContext);\r\n\r\n  const [user, setUser] = useState({\r\n    username: '',\r\n    password: ''\r\n  });\r\n\r\n  const [loading, setLoading] = useState(false);\r\n\r\n\r\n  function handleChange(event) {\r\n    const { name, value } = event.target;\r\n    setUser(preUser => {\r\n      return {\r\n        ...preUser,\r\n        [name]: value\r\n      }\r\n    });\r\n  }\r\n\r\n  async function handleLogin(event) {\r\n    event.preventDefault();\r\n\r\n    const { username, password } = user;\r\n    if (username && password) {\r\n      setLoading(true);\r\n      const Url = 'https://vue-course-api.hexschool.io/admin/signin';\r\n      const response = await fetch(Url, {\r\n        method: \"POST\",\r\n        body: JSON.stringify(user),\r\n        credentials: 'include',\r\n        headers: { 'content-type': 'application/json' }\r\n      });\r\n      const result = await response.json();\r\n      const { success, message } = result;\r\n      if (success) {\r\n        setLoading(false);\r\n        userDispatch({ type: 'LOGO_IN' });\r\n        history.push('/shop-react/products');\r\n      } else {\r\n        setLoading(false);\r\n        history.replace('/shop-react/login');\r\n        alert.error(message);\r\n      }\r\n    } else if (!username && password) {\r\n      alert.show('請輸入E-mail');\r\n    } else if (!password && username) {\r\n      alert.show('請輸入Password')\r\n    } else {\r\n      alert.show('請輸入Email 跟Password')\r\n    }\r\n\r\n  }\r\n\r\n  if (loading) {\r\n    return <Loading />\r\n  }\r\n\r\n\r\n  return (\r\n    <div className='w-full sm:max-w-xs mx-auto mt-4'>\r\n      <form onSubmit={handleLogin} className='bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4'>\r\n        <h2 className=\"my-1 text-4xl text-teal-500\">LogoIn</h2>\r\n        <div className='my-4'>\r\n          <label className='block text-teal-500 text-sm font-bold mb-2'> Email :\r\n        <input\r\n              className='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline'\r\n              type=\"email\"\r\n              placeholder='email'\r\n              name='username'\r\n              onChange={handleChange}\r\n              value={user.username} />\r\n          </label>\r\n        </div>\r\n        <div className='mb-4'>\r\n          <label className='block text-teal-500 text-sm font-bold mb-2'> Password :\r\n        <input\r\n              className='shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline'\r\n              type=\"current-password\"\r\n              placeholder='password'\r\n              name=\"password\"\r\n              onChange={handleChange}\r\n              value={user.password} />\r\n          </label>\r\n        </div>\r\n        <div className='flex items-center justify-between'>\r\n          <button className='bg-teal-500 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline' type='submit'>Submit</button>\r\n          <button className='inline-block align-baseline font-bold text-sm text-teal-500 hover:text-teal-800' onClick={() => { history.push('/shop-react/home') }}>Back</button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n\r\n  )\r\n}"],"sourceRoot":""}