{"version":3,"sources":["components/Pages.js","js/setTime.js","components/Coupon/EditCoupon.js","components/Coupon/Coupon.js","components/Coupon/CouponsList.js"],"names":["Pages","num","setDePage","dePage","useState","pages","setPages","useEffect","newPages","i","push","setPagesArray","className","length","onClick","map","page","key","changeToDate","number","isTrue","dateTime","Date","setTime","year","getFullYear","month","addZero","getMonth","day","getDate","hour","getHours","min","getMinutes","EditCoupon","open","setOpen","coupon","handleChange","updateCoupon","addCoupon","handleCancel","style","htmlFor","id","value","title","name","onChange","code","percent","type","due_date","checked","is_enabled","hasOwnProperty","Coupon","updateIsenable","openUpdateCoupon","updateDate","e","CouponsList","alert","useAlert","coupons","setCoupons","setCoupon","loading","setLoading","fetchData","a","Url","fetch","credentials","response","json","data","success","pagination","total_pages","method","body","JSON","stringify","headers","result","message","error","event","item","target","Loading","valueAsNumber","preCoupon"],"mappings":"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","file":"static/js/4.88411b27.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react'\n\n\nexport default function Pages({ num, setDePage, dePage }) {\n  const [pages, setPages] = useState([]);\n\n  useEffect(() => {\n    setPagesArray(num)\n  }, [num])\n\n  function setPagesArray(num) {\n    const newPages = []\n    if (num > 2) {\n      for (let i = 1; i < (num + 1); i++) {\n        newPages.push(i);\n      }\n      setPages(newPages);\n    }\n  }\n\n  const active = 'bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-l';\n  const normal = 'bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-l'\n  return (\n    <ul className='max-w-sm inline-flex mt-2'>\n      {\n        (pages.length > 1 && dePage !== 1) && <li><button className='bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-l' onClick={() => setDePage(dePage - 1)}>Pre</button> </li>\n      }\n      {\n        pages.length > 1 && (pages.map((page, i) => (\n          <li key={i}>\n            <button className={dePage === page ? active : normal} onClick={() => setDePage(page)}>\n              {page}\n            </button>\n          </li>\n        )))\n      }\n      {\n        (pages.length > 1 && dePage !== num) && <li> <button className='bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-r' onClick={() => setDePage(dePage + 1)}>Next</button></li>\n      }\n\n    </ul>\n  )\n} ","export const changeToDate = (number, isTrue = false) => {\r\n  let dateTime = new Date();\r\n  dateTime.setTime(number * 1000);\r\n  const year = dateTime.getFullYear();\r\n  const month = addZero(dateTime.getMonth() + 1);\r\n  const day = addZero(dateTime.getDate());\r\n  const hour = addZero(dateTime.getHours());\r\n  const min = addZero(dateTime.getMinutes());\r\n\r\n  let date;\r\n  if (isTrue) {\r\n    date = `${year}-${month}-${day}- ${hour}: ${min}`;\r\n  } else {\r\n    date = `${year}-${month}-${day}`;\r\n  }\r\n  return date;\r\n}\r\n\r\nfunction addZero(number) {\r\n  if (number < 10) {\r\n    number = `0${number}`\r\n  }\r\n  return number;\r\n}","import React from 'react'\r\nimport { changeToDate } from '../../js/setTime';\r\n\r\nexport default function EditCoupon({ open, setOpen, coupon, handleChange, updateCoupon, addCoupon, handleCancel }) {\r\n  const style = {\r\n    div: 'w-full md:w-1/2 lg:w-1/3  px-3 mt-3 mb-6 md:mb-0',\r\n    label: 'block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2',\r\n    input: 'appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\" id=\"grid-last-name',\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <button className='my-2 bg-teal-500 hover:bg-teal-700 text-white font-bold py-1 px-2 rounded' onClick={() => setOpen(!open)}>Add Coupon</button>\r\n      {\r\n        open && (\r\n          <div className='flex flex-wrap mb-6'>\r\n            <section className={style.div}>\r\n              <label\r\n                className={style.label} htmlFor='title'>優惠卷名稱:</label>\r\n              <input\r\n                className={style.input}\r\n                id='title'\r\n                value={coupon.title || ''}\r\n                name='title'\r\n                onChange={handleChange} />\r\n            </section>\r\n            <section className={style.div}>\r\n              <label className={style.label} htmlFor='code'>代碼:</label>\r\n              <input\r\n                className={style.input}\r\n                id='code'\r\n                value={coupon.code || ''}\r\n                name='code'\r\n                onChange={handleChange} />\r\n            </section>\r\n            <section className={style.div}>\r\n              <label className={style.label} htmlFor='percent'>折扣</label>\r\n              <input\r\n                className={style.input}\r\n                id='percent'\r\n                value={coupon.percent || ''}\r\n                name='percent'\r\n                onChange={handleChange} />\r\n            </section>\r\n            <section className={style.div}>\r\n              <label className={style.label} htmlFor='due_date'>使用期限:</label>\r\n              <input\r\n                className={style.input}\r\n                id='due_date'\r\n                type='date'\r\n                value={changeToDate(coupon.due_date) || ''}\r\n                name='due_date'\r\n                onChange={handleChange} />\r\n            </section>\r\n            <section className={style.div}>\r\n              <label className={style.label} htmlFor='is_enable'>是否啟用:</label>\r\n              <input\r\n                id='is_enable'\r\n                type='checkbox'\r\n                checked={(coupon.is_enabled === 1 ? true : false) || ''}\r\n                name='is_enabled'\r\n                onChange={handleChange} />\r\n            </section>\r\n            <div className='w-full md:w-1/2 lg:w-1/3  px-3 mt-3 mb-6 md:mb-0 sm:relative flex justify-end items-end'>\r\n              {\r\n                coupon.hasOwnProperty('id') ? <button className='bg-teal-500 hover:bg-teal-700 text-white font-bold py-1 px-2 rounded' onClick={updateCoupon}>Update</button> : <button className='bg-teal-500 hover:bg-teal-700 text-white font-bold py-1 px-2 rounded' onClick={addCoupon}>add</button>\r\n              }\r\n              <button className='bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded ml-2' onClick={handleCancel}>Cancel</button>\r\n            </div>\r\n\r\n          </div>\r\n        )\r\n      }\r\n    </>\r\n  )\r\n}","import React from 'react'\r\nimport { changeToDate } from '../../js/setTime';\r\n\r\nexport default function Coupon({ coupon, updateIsenable, openUpdateCoupon, updateDate }) {\r\n\r\n  function handleDelete() {\r\n    updateDate(null, coupon.id, \"DELETE\")\r\n  }\r\n\r\n  return (\r\n    <tr className='text-right'>\r\n      <td className='border px-4 py-2'>{coupon.title}</td>\r\n      <td className='border px-4 py-2'>{coupon.code}</td>\r\n      <td className='border px-4 py-2'>{coupon.percent / 100} 折</td>\r\n      <td className='border px-4 py-2'>{changeToDate(coupon.due_date)}</td>\r\n      <td className='border px-4 py-2'><input\r\n        type='checkbox'\r\n        onChange={(e) => updateIsenable(e, coupon)}\r\n        checked={coupon.is_enabled === 1 ? true : false} /></td>\r\n      <td className='border px-4 py-2'><button className='bg-teal-500 hover:bg-teal-700 text-white font-bold py-1 px-2 rounded' onClick={() => openUpdateCoupon(coupon)}>編輯</button></td>\r\n      <td className='border px-4 py-2'> <button className='bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded' onClick={handleDelete}>刪除</button></td>\r\n    </tr>\r\n  )\r\n}","import React, { useState, useEffect } from 'react';\r\nimport { useAlert } from 'react-alert';\r\n\r\nimport EditCoupon from './EditCoupon';\r\nimport Coupon from './Coupon';\r\nimport Loading from '../Loading/Loading';\r\nimport Pages from '../Pages';\r\n\r\nexport default function CouponsList() {\r\n\r\n  const alert = useAlert();\r\n  const [coupons, setCoupons] = useState(null);\r\n  const [coupon, setCoupon] = useState({});\r\n  const [loading, setLoading] = useState(true);\r\n  const [open, setOpen] = useState(false);\r\n  const [dePage, setDePage] = useState(1);\r\n  const [pages, setPages] = useState(null)\r\n\r\n  async function fetchData(page) {\r\n    const Url = `https://vue-course-api.hexschool.io/api/jay/admin/coupons?page=${page}`;\r\n    const response = await fetch(Url, {\r\n      credentials: 'include',\r\n    });\r\n    const data = await response.json();\r\n\r\n    const { success, pagination, coupons } = data;\r\n\r\n    if (success) {\r\n      setCoupons(coupons);\r\n      setPages(pagination.total_pages)\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchData(dePage);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [dePage]);\r\n\r\n  async function updateDate(data, id, type) {\r\n    const Url = id ? `https://vue-course-api.hexschool.io/api/jay/admin/coupon/${id}` : 'https://vue-course-api.hexschool.io/api/jay/admin/coupon';\r\n    const response = await fetch(Url, {\r\n      method: type,\r\n      body: (type === \"PUT\" || type === 'POST') && JSON.stringify({ data: { ...data } }),\r\n      credentials: 'include',\r\n      headers: { 'content-type': (type === 'PUT' || type === 'POST') && 'application/json' },\r\n    });\r\n    const result = await response.json();\r\n    const { success, message } = result;\r\n    if (success) {\r\n      fetchData();\r\n      if (message) {\r\n        alert.success(message);\r\n      }\r\n    } else {\r\n      if (message) {\r\n        alert.error(message);\r\n      }\r\n    }\r\n  }\r\n\r\n  function updateIsenable(event, item) {\r\n    const newitem = { ...item, is_enabled: event.target.checked ? 1 : 0 };\r\n    updateDate(newitem, item.id, 'PUT');\r\n  }\r\n\r\n  function openUpdateCoupon(item) {\r\n    setCoupon(item);\r\n    setOpen(true);\r\n  }\r\n\r\n  function handleChange(event) {\r\n    let { name, value, checked, valueAsNumber } = event.target;\r\n    if (name === 'due_date') {\r\n      value = valueAsNumber / 1000;\r\n    } else if (name === 'is_enabled') {\r\n      value = checked ? 1 : 0;\r\n    }\r\n    setCoupon(preCoupon => {\r\n      return {\r\n        ...preCoupon,\r\n        [name]: value\r\n      }\r\n    })\r\n  }\r\n\r\n  function updateCoupon() {\r\n    updateDate(coupon, coupon.id, 'PUT');\r\n    setOpen(false);\r\n  }\r\n\r\n  const addCoupon = () => {\r\n    updateDate(coupon, null, 'POST');\r\n    setCoupon({});\r\n    setOpen(false);\r\n  }\r\n\r\n  function handleCancel() {\r\n    setCoupon({})\r\n    setOpen(false)\r\n  }\r\n\r\n  if (loading) {\r\n    return <Loading />\r\n  }\r\n\r\n  return (\r\n    <div className='container'>\r\n      <h2 className='text-2xl'>Coupon</h2>\r\n      <EditCoupon\r\n        open={open}\r\n        setOpen={setOpen}\r\n        coupon={coupon}\r\n        handleChange={handleChange}\r\n        updateCoupon={updateCoupon}\r\n        addCoupon={addCoupon}\r\n        handleCancel={handleCancel}\r\n      />\r\n      <table className=\"table-auto w-full\">\r\n        <thead>\r\n          <tr>\r\n            <th className='border px-4 py-2'>優惠卷</th>\r\n            <th className='border px-4 py-2'>代碼</th>\r\n            <th className='border px-4 py-2'>折扣</th>\r\n            <th className='border px-4 py-2'>使用期限</th>\r\n            <th className='border px-4 py-2'>使用</th>\r\n            <th className='border px-4 py-2'>編輯</th>\r\n            <th className='border px-4 py-2'>刪除</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {\r\n            coupons && coupons.map((coupon, i) => {\r\n              return <Coupon\r\n                key={i}\r\n                coupon={coupon}\r\n                updateIsenable={updateIsenable}\r\n                openUpdateCoupon={openUpdateCoupon}\r\n                updateDate={updateDate}\r\n              />\r\n            })\r\n          }\r\n        </tbody>\r\n      </table>\r\n      <Pages dePage={dePage} setDePage={setDePage} num={pages} />\r\n    </div>\r\n  )\r\n}"],"sourceRoot":""}