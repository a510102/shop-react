{"version":3,"sources":["components/Pages.js","components/Shop/ShopProduct.js","components/Shop/Shop.js"],"names":["Pages","num","setDePage","dePage","useState","pages","setPages","useEffect","newPages","i","push","setPagesArray","className","length","onClick","map","page","key","ShopProduct","React","memo","data","history","useHistory","alert","useAlert","dispatch","useDispatch","id","a","product","product_id","qty","Url","fetch","method","body","JSON","stringify","headers","response","json","result","message","success","show","datas","type","cart","imageUrl","category","title","price","origin_price","src","alt","handleAddToCart","number","Shop","products","useSelector","store","productsState","loading","setLoading","categ","setCateg","pagination","total_pages","console","log","fetchProducts","Loading","items","text","style","filterProducts","filter","is_enabled","categorys","indexOf","item"],"mappings":"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","file":"static/js/8.61a96ea3.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react'\n\n\nexport default function Pages({ num, setDePage, dePage }) {\n  const [pages, setPages] = useState([]);\n\n  useEffect(() => {\n    setPagesArray(num)\n  }, [num])\n\n  function setPagesArray(num) {\n    const newPages = []\n    if (num > 2) {\n      for (let i = 1; i < (num + 1); i++) {\n        newPages.push(i);\n      }\n      setPages(newPages);\n    }\n  }\n\n  const active = 'bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-l';\n  const normal = 'bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-l'\n  return (\n    <ul className='max-w-sm inline-flex mt-2'>\n      {\n        (pages.length > 1 && dePage !== 1) && <li><button className='bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-l' onClick={() => setDePage(dePage - 1)}>Pre</button> </li>\n      }\n      {\n        pages.length > 1 && (pages.map((page, i) => (\n          <li key={i}>\n            <button className={dePage === page ? active : normal} onClick={() => setDePage(page)}>\n              {page}\n            </button>\n          </li>\n        )))\n      }\n      {\n        (pages.length > 1 && dePage !== num) && <li> <button className='bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-r' onClick={() => setDePage(dePage + 1)}>Next</button></li>\n      }\n\n    </ul>\n  )\n} ","import React from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { useAlert } from 'react-alert';\r\nimport { useDispatch } from 'react-redux';\r\n\r\nconst ShopProduct = React.memo(({ data }) => {\r\n    const history = useHistory();\r\n    const alert = useAlert();\r\n    const dispatch = useDispatch();\r\n\r\n    async function handleAddToCart(id) {\r\n        const product = { data: { product_id: id, qty: 1 } };\r\n        let Url = 'https://vue-course-api.hexschool.io/api/jay/cart';\r\n        let response = await fetch(Url, {\r\n            method: \"POST\",\r\n            body: JSON.stringify(product),\r\n            headers: { 'content-type': 'application/json' }\r\n        });\r\n        const result = await response.json();\r\n        const { message, success } = result;\r\n        if (success) {\r\n            alert.show(message);\r\n            Url = 'https://vue-course-api.hexschool.io/api/jay/cart';\r\n            response = await fetch(Url);\r\n            const datas = await response.json();\r\n            if (datas.success) {\r\n                dispatch({ type: \"UPDATE_CART\", cart: datas.data })\r\n            }\r\n        }\r\n    }\r\n\r\n    function handlePathToProduct(number) {\r\n        history.push(`/shop-react/shop/${number}`)\r\n    }\r\n    const { id, imageUrl, category, title, price, origin_price } = data;\r\n    return (\r\n        <li id={id} className=\"mb-1 rounded overflow-hidden shadow-lg  rounded-lg shadow-md relative h-auto\">\r\n            <div className='relative w-full h-48 mx-auto bg-gray-200'>\r\n                <img src={imageUrl} alt=\"product\" className='absolute max-h-full max-w-full top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2' />\r\n            </div>\r\n            <div className='px-5 py-2  inset-x-0 bottom-0 bg-gray-100 w-full  rounded'>\r\n                <h3 className=' flex justify-between text-teal-700 font-bold text-sm mb-2'>\r\n                    <span>{category} :</span>\r\n                    <span>{title}</span>\r\n                </h3>\r\n                <p className='flex justify-between text-teal-700 text-base'>\r\n                    <span>原價: {origin_price}元</span>\r\n                    <span>{price && `特價: ${price}元 `}</span>\r\n                </p>\r\n                <div className='flex items-center justify-between mt-2'>\r\n                    <button onClick={() => handleAddToCart(id)} className=\"bg-green-400 hover:bg-green-600 text-white font-bold py-1 px-2 rounded-full\">ADD</button>\r\n                    <button onClick={() => handlePathToProduct(id)} className=\"bg-blue-400 hover:bg-blue-600 text-white font-bold py-1 px-2 rounded-full\">詳細內容</button>\r\n                </div>\r\n            </div>\r\n        </li>\r\n    )\r\n})\r\n\r\nexport default ShopProduct;","import React, { useState, useEffect } from 'react'\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport ShopProduct from './ShopProduct';\r\nimport Loading from '../Loading/Loading';\r\nimport Pages from '../Pages';\r\n\r\n\r\n\r\nconst Shop = () => {\r\n    const dispatch = useDispatch();\r\n    const products = useSelector(store => store.productsState.products);\r\n    const [loading, setLoading] = useState(true);\r\n    const [dePage, setDePage] = useState(1)\r\n    const [pages, setPages] = useState(null)\r\n    const [categ, setCateg] = useState('all');\r\n    console.log('shop')\r\n\r\n    useEffect(() => {\r\n        fetchProducts(dePage);\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [dePage])\r\n\r\n    async function fetchProducts(page) {\r\n        const Url = `https://vue-course-api.hexschool.io/api/jay/products?page=${page}`;\r\n        const response = await fetch(Url);\r\n        const datas = await response.json();\r\n        const { success, products, pagination } = datas;\r\n        if (success) {\r\n            dispatch({ type: \"UPDATE_PRODUCT\", product: products });\r\n            setLoading(false);\r\n            setPages(pagination.total_pages)\r\n        }\r\n    }\r\n\r\n    function handleCategory(items, text) {\r\n        if (text === 'all') {\r\n            return items\r\n        } else {\r\n            return items.filter(item => item.category === text)\r\n        }\r\n    }\r\n\r\n    if (loading) {\r\n        return <Loading />\r\n    }\r\n\r\n    if (!products) {\r\n        return <div> error 404</div>\r\n    }\r\n\r\n    const style = {\r\n        active: 'm-2 mx-auto bg-white w-16 text-teal-600 text-white font-bold py-1 px-2 rounded-full',\r\n        normal: 'm-2 mx-auto bg-teal-500 w-16 hover:bg-teal-600 text-white font-bold py-1 px-2 rounded-full',\r\n    }\r\n    const filterProducts = products.filter(data => data.is_enabled === 1);\r\n    const categorys = products.map(product => product.category).filter((product, i, a) => a.indexOf(product) === i);\r\n    return (\r\n        <div className='container mx-auto h-auto min-h-screen'>\r\n            <div className='grid grid-cols-3 sm:grid-cols-6 gap-2 lg:gap-4'>\r\n                <button\r\n                    onClick={() => setCateg('all')}\r\n                    className={categ === 'all' ? style.active : style.normal}>全部</button>\r\n                {categorys && categorys.map((category, i) =>\r\n                    <button\r\n                        onClick={() => setCateg(category)}\r\n                        key={i}\r\n                        className={categ === category ? style.active : style.normal}>{category}</button>\r\n                )}\r\n            </div>\r\n            <ul className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 lg:gap-4 p-2 md:p-0\">\r\n                {\r\n                    filterProducts.length > 0 ? handleCategory(filterProducts, categ).map(data =>\r\n                        <ShopProduct data={data} key={data.id} />\r\n                    ) : (\r\n                            <div>現在還沒有商品喲~</div>)\r\n                }\r\n                <Pages dePage={dePage} setDePage={setDePage} num={pages} />\r\n            </ul>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Shop;"],"sourceRoot":""}